<!--
!name:minimum_residual_affine_sets
!need:projections_on_affine_sets
!need:projections_on_affine_sets
!need:matrix_trace
-->

Â§ Why â¦‰
Â¶ â¦Š
  â€– We want to find a low-dimensional affine set into which we
    can project some high-dimensional data. â¦‰
â¦‰

Â§ Problem â¦‰
Â¶ â¦Š
  â€– For $a âˆˆ ğ—¥^n$ and $U âˆˆ ğ—¥^{n Ã— k}$, the set $W(a, U) =
    \Set{a + Uz}{z âˆˆ ğ—¥^n}$ is an affine set. â¦‰

  â€– Denote the projection of $x âˆˆ ğ—¥^n$ onto $W(a, U)$ by
    $\proj_{W(a, U)}(x)$. â¦‰
â¦‰

Â¶ â¦Š
  â€– \begin{problem} â¦‰

  â€– Given $x^{(1)}, â€¦, x^{(m)} âˆˆ ğ—¥^n$, and a dimension $k$,
    find $a âˆˆ ğ—¥^n$ and $U âˆˆ ğ—¥^{n Ã— k}$ with $U^âŠ¤U = I$ to
    minimize
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– âˆ‘_{i = 1}^{m} \norm{x^{(i)} - \proj_{W(a, U)}(x^{(i)})}^2, â¦‰
    â¦‰
    the sum of squared distances between $x^{(i)}$ and its
    projection on $W(a, U)$. â¦‰

  â€– \end{problem} â¦‰
â¦‰

Â¶ â¦Š
  â€– Express $\proj_{W(a, U)}(x)$ as $UU^âŠ¤x + (I - UU^âŠ¤)a$ (see
    \sheetref{projections_on_affine_sets}{Projections on Affine Sets}). â¦‰

  â€– We want to find $a âˆˆ ğ—¥^n$ and $U âˆˆ ğ—¥^{n Ã— k}$ to
    minimize
    â—‡ â¦Š
      â€– âˆ‘_{i = 1}^{n} \norm{x^{(i)} - UU^âŠ¤ x^{(i)} - (I-UU^âŠ¤)a}^2. â¦‰
    â¦‰â¦‰

  â€– Fix $U âˆˆ ğ—¥^{n Ã— k}$. â¦‰

  â€– Define $A âˆˆ ğ—¥^{nm Ã— n}$, $B âˆˆ ğ—¥^{mn Ã— mn}$, and
    $\tilde{x} âˆˆ ğ—¥^{nm}$ by
    â—‡ â¦Š
      â€– \scriptsize â¦‰

      â€– A = \bmat{ â¦‰

      â€– I - UU^âŠ¤ áœ¶ â¦‰

      â€– \vdots áœ¶ â¦‰

      â€– I - UU^âŠ¤ áœ¶ â¦‰

      â€– },\text{ } B = \bmat{ â¦‰

      â€– I - UU^âŠ¤ â²&â³ â‹¯ â²&â³ 0áœ¶ â¦‰

      â€– â²&â³ \ddots â²&â³ áœ¶ â¦‰

      â€– 0 â²& â³ â‹¯ â²& â³ I - UU^âŠ¤ áœ¶ â¦‰

      â€– }, \text{ and } â¦‰

      â€– \tilde{x} = \bmat{ â¦‰

      â€– x^{(1)} áœ¶ â¦‰

      â€– \vdots áœ¶ â¦‰

      â€– x^{(m)} â¦‰

      â€– }. â¦‰
    â¦‰â¦‰

  â€– Then the objective is equivalent to
    â—‡ â¦Š
      â€– \norm{Aa - B \tilde{x}}^2 â¦‰
    â¦‰â¦‰

  â€– Any minimizer $a^â˜…$ satisfies the normal equations
    â—‡ â¦Š
      â€– A^âŠ¤Aa^â˜… = A^âŠ¤B\tilde{x} â¦‰
    â¦‰â¦‰

  â€– Since $(I - UU^âŠ¤)^âŠ¤ = I - UU^âŠ¤$ and $(I - UU^âŠ¤)^2 = I -
    UU^âŠ¤$,
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– A^âŠ¤A = âˆ‘_{i = 1}^{m} I - UU^âŠ¤ = m(I - UU^âŠ¤) â¦‰
    â¦‰
    and
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– A^âŠ¤B = \bmat{I - UU^âŠ¤ â²&â³ â‹¯ â²&â³ I - UU^âŠ¤}. â¦‰
    â¦‰â¦‰

  â€– Consequently, we can express $A^âŠ¤Aa^â˜… = A^âŠ¤B\tilde{x}$ as
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– m(I - UU^âŠ¤)a^â˜… = âˆ‘_{i = 1}^{m} (I - UU^âŠ¤)x^{(i)}. â¦‰
    â¦‰â¦‰

  â€– So $a^â˜…$ is any vector satisfying
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– (I - UU^âŠ¤)a^â˜… = (I- UU^âŠ¤)(1/m)âˆ‘_{i = 1}^{m} (I -
        UU^âŠ¤)x^{(i)}. â¦‰
    â¦‰â¦‰

  â€– One such point satisfying the above is $\bar{x} = (1/m)âˆ‘_{i
    = 1}^{m}x^{(i)}$. â¦‰

  â€– An expedient choice, as it does not depnd on $U$. â¦‰
â¦‰

Â¶ â¦Š
  â€– Now we want to find $U âˆˆ ğ—¥^{n Ã— k}$ to minimize
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– âˆ‘_{i = 1}^{m} \norm{(I-UU^âŠ¤)(x^{(i)} - \bar{x})}^2. â¦‰
    â¦‰â¦‰

  â€– Express the $i$th term of the sum as
    â—‡ â¦Š
      â€– \textstyle â¦‰

      â€– \begin{aligned} â¦‰

      â€– \norm{(I - UU^âŠ¤)(x^{(i)} - \bar{x})}^2 â²&â³ = (x-\bar{x})(I
        - UU^âŠ¤)^âŠ¤(I - UU^âŠ¤)(x^{(i)} - \bar{x}) áœ¶ â¦‰

      â€– â²&â³ = (x^{(i)} - \bar{x})^âŠ¤(I - UU^âŠ¤)(x ^{(i)} -
        \bar{x}) áœ¶ â¦‰

      â€– â²&â³ = \norm{x^{(i)} - \bar{x}}^2 - \norm{U^âŠ¤(x^{(i)} -
        \bar{x})}^2. â¦‰

      â€– \end{aligned} â¦‰
    â¦‰â¦‰

  â€– The first term is a constant with respect to $U$. Define
    $\bar{X} âˆˆ ğ—¥^{n Ã— m}$ by
    â—‡ â¦Š
      â€– \bar{X} = \bmat{x^{(1)} - \bar{x} â²&â³ â‹¯ â²&â³ x^{(m)} -
        \bar{x}}. â¦‰
    â¦‰
    Express the sum of the second terms by
    â—‡ â¦Š
      â€– \norm{U^âŠ¤\bar{X}}_F = \tr \bar{X}^âŠ¤UU^âŠ¤\bar{X} =
        \tr(U^âŠ¤\bar{X}\bar{X}^âŠ¤U). â¦‰
    â¦‰â¦‰

  â€– So we seek $U âˆˆ ğ—¥^{n Ã— k}$ with $U^âŠ¤U = I$ to maximize
    â—‡ â¦Š
      â€– \tr(U^âŠ¤\bar{X}\bar{X}^âŠ¤U). â¦‰
    â¦‰â¦‰
â¦‰

<tex>
  â€– \blankpage â¦‰
</tex>
