\input{../../sheet.tex}
\sbasic
\input{../set_complements/macros.tex}
\input{../sets/macros.tex}
\input{../set_equality/macros.tex}
\input{../set_symmetric_differences/macros.tex}
\input{../subset_systems/macros.tex}
\input{../sentences/macros.tex}
\input{../set_inclusion/macros.tex}
\input{../set_operations/macros.tex}
\input{../subset_algebras/macros.tex}
\input{../operations/macros.tex}
\input{../set_specification/macros.tex}
\input{../unordered_pairs/macros.tex}
\input{../power_set/macros.tex}
\input{../objects/macros.tex}
\input{../partitions/macros.tex}
\input{../characteristic_functions/macros.tex}
\input{../measures/macros.tex}
\input{../algebras/macros.tex}
\input{../set_unions/macros.tex}
\input{../set_intersections/macros.tex}
\input{../empty_set/macros.tex}
\input{../functions/macros.tex}
\input{../ordered_pairs/macros.tex}
\input{../families/macros.tex}
\input{../zero/macros.tex}
\input{../identity/macros.tex}
\input{../simple_functions/macros.tex}
\input{../measurable_functions/macros.tex}
\input{../natural_sums/macros.tex}
\input{../family_operations/macros.tex}
\input{../common_sense/macros.tex}
\input{../natural_numbers/macros.tex}
\input{../injective_functions/macros.tex}
\input{../relations/macros.tex}
\input{../natural_order/macros.tex}
\input{../natural_families/macros.tex}
\input{../natural_differences/macros.tex}
\input{../integer_numbers/macros.tex}
\input{../squares/macros.tex}
\input{../natural_products/macros.tex}
\input{../equations/macros.tex}
\input{../simple_integrals/macros.tex}
\input{../natural_summation/macros.tex}
\input{../probability/macros.tex}
\input{../cardinality/macros.tex}
\input{../partial_orders/macros.tex}
\input{../direct_products/macros.tex}
\input{../rational_numbers/macros.tex}
\input{../square_numbers/macros.tex}
\input{../equation_solutions/macros.tex}
\input{../nonnegative_integrals/macros.tex}
\input{../real_summation/macros.tex}
\input{../probability_outcomes/macros.tex}
\input{../intervals/macros.tex}
\input{../space/macros.tex}
\input{../total_orders/macros.tex}
\input{../datasets/macros.tex}
\input{../real_numbers/macros.tex}
\input{../natural_square_roots/macros.tex}
\input{../real_integrals/macros.tex}
\input{../probability_distributions/macros.tex}
\input{../real_functions/macros.tex}
\input{../n-dimensional_space/macros.tex}
\input{../optimizers/macros.tex}
\input{../distribution_selection/macros.tex}
\input{../real_square_roots/macros.tex}
\input{../probability_densities/macros.tex}
\input{../exponential/macros.tex}
\input{../multivariate_real_densities/macros.tex}
\input{../maximum_likelihood/macros.tex}
\input{../density_selection/macros.tex}
\input{../normal_densities/macros.tex}
\input{../density_maximum_likelihood/macros.tex}
\input{./macros.tex}
\sstart
\stitle{Normal Maximum Likelihood}
%!!need:calculus ;) multivariate, too...

\ssection{Why}

We want to select a normal density which summarizes well a dataset.

\ssection{Formulation}

Let $D = (x^1, \dots, x^n)$ be a dataset in $\R$.
We want to select a density from among normal densities, which require specifying a mean and covariance.

Following the principle of maximum likelihood, we want to solve
\[
  \maximizationn{\mu,\sigma \in \R}{
    \prod_{k = 1}^{n}  \normaldensity{x^k}{\mu}{\sigma}
  }{
    \sigma > 0 \\
  }
\]
We call a solution to the above problem a \t{maximum likelihood normal density} with respect to the dataset.

\ssection{Solution}

\begin{prop}

Let $(x^1, \dots, x^n)$ be a dataset in $\R$.
Let $f$ be a normal density with mean
$$\frac{1}{n} \sum_{k = 1}^{n} x^k$$
and covariance
$$\frac{1}{n} \sum_{k = 1}^{n} \left(x^k - \frac{1}{n} \sum_{k = 1}^{n} x^k\right)^2.$$
Then $f$ is a maximum likelihood normal density.
\begin{proof}
  Every normal density has two parameters: the mean
  and the covariance.
  If the likelihood of one normal is less than or equal
  to the likelihood of another, then so is are their
  log likelihoods.
  Let $f$ be a normal density with parameter $\mu$ and $\sigma^2$.
  We express the log likelihood of
  $f$ by
  \[
    \sum_{k = 1}^{n} \left( \frac{1}{2\sigma^2}(x^k - \mu)^2 - \frac{1}{2}\log2\pi\sigma^2\right)
  \]
  The partial derivative of the log likelihood with
  respect to the mean $(\partial_{\mu} \ell): \R^2 \to \R$ is
  \[
    (\partial_\mu \ell)(\mu, \sigma^2) = - \sum_{k = 1}^{n} \frac{1}{\sigma^2}(x - \mu)
  \]
  and with respect to the covariance $(\partial_{\sigma^2} \ell): \R^2 \to \R$ is
  \[
    (\partial_{\sigma^2} \ell)(\mu, \sigma^2) =
    \left(\frac{-1}{2(\sigma^2)^{2}}\sum_{k = 1}^{n}(x^k - \mu)^2\right)- \frac{1}{2\sigma^2}
  \]
  We are interested in finding $\mu_0 \in \R$ and $\sigma^2_0 > 0$, at which
  $\partial_\mu \ell(\mu_0, \sigma^2_0) = 0$ and
  $\partial_{\sigma^2} \ell(\mu_0, \sigma^2_0) = 0$.
  So we have two equations.
  First, notice that
  $\partial_\mu \ell$ is zero if an only if
  its first argument (the mean) is $\frac{1}{n} \sum_{k = 1}^{n} x^k$.
  Second, notice that for all $\mu, \sigma^2$,
  $\partial_{\sigma^2}\ell$ is zero if and only if
  \[
    \sigma^2 = \sum_{k = 1}^{n} (x^k - \mu)^2.
  \]
  So the pair
  \[
    \left(\frac{1}{n}\sum_{k = 1}^{k} x^k, \frac{1}{n} \sum_{k = 1}^{n} (x_k - \frac{1}{n} \sum_{k = 1}^{n}  x^k)^2\right)
  \]
  is a stationary point of $\ell$.
\end{proof}
\end{prop}
\strats
