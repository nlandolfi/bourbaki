\input{../../sheet.tex}
\sbasic
\input{../objects/macros.tex}
\input{../identity/macros.tex}
\input{../set_equality/macros.tex}
\input{../sets/macros.tex}
\input{../ordered_pairs/macros.tex}
\input{../equations/macros.tex}
\input{../families/macros.tex}
\input{../functions/macros.tex}
\input{../set_inclusion/macros.tex}
\input{../sentences/macros.tex}
\input{../relation_properties/macros.tex}
\input{../relations/macros.tex}
\input{../natural_order/macros.tex}
\input{../natural_families/macros.tex}
\input{../probability_events/macros.tex}
\input{../operations/macros.tex}
\input{../solving_equations/macros.tex}
\input{../family_operations/macros.tex}
\input{../arithmetic/macros.tex}
\input{../common_sense/macros.tex}
\input{../natural_numbers/macros.tex}
\input{../injective_functions/macros.tex}
\input{../set_specification/macros.tex}
\input{../partial_orders/macros.tex}
\input{../length_common_notions/macros.tex}
\input{../set_operations/macros.tex}
\input{../graphs/macros.tex}
\input{../direct_products/macros.tex}
\input{../event_probabilities/macros.tex}
\input{../algebras/macros.tex}
\input{../integer_numbers/macros.tex}
\input{../natural_summation/macros.tex}
\input{../probability/macros.tex}
\input{../cardinality/macros.tex}
\input{../total_orders/macros.tex}
\input{../distance/macros.tex}
\input{../trees/macros.tex}
\input{../marginal_distributions/macros.tex}
\input{../conditional_event_probability/macros.tex}
\input{../groups/macros.tex}
\input{../rational_numbers/macros.tex}
\input{../real_summation/macros.tex}
\input{../probability_outcomes/macros.tex}
\input{../intervals/macros.tex}
\input{../optimization/macros.tex}
\input{../metrics/macros.tex}
\input{../logarithm/macros.tex}
\input{../rooted_trees/macros.tex}
\input{../conditional_distributions/macros.tex}
\input{../fields/macros.tex}
\input{../identity_matrices/macros.tex}
\input{../matrices/macros.tex}
\input{../space/macros.tex}
\input{../real_numbers/macros.tex}
\input{../probability_distributions/macros.tex}
\input{../approximation/macros.tex}
\input{../similarity_functions/macros.tex}
\input{../entropy/macros.tex}
\input{../cross_entropy/macros.tex}
\input{../differential_entropy/macros.tex}
\input{../rooted_tree_distributions/macros.tex}
\input{../vectors/macros.tex}
\input{../symmetric_matrices/macros.tex}
\input{../quadratic_forms/macros.tex}
\input{../probability_densities/macros.tex}
\input{../real_matrices/macros.tex}
\input{../n-dimensional_space/macros.tex}
\input{../tree_distributions/macros.tex}
\input{../distribution_approximation/macros.tex}
\input{../relative_entropy/macros.tex}
\input{../differential_cross_entropy/macros.tex}
\input{../rooted_tree_densities/macros.tex}
\input{../transpose/macros.tex}
\input{../positive_definite_matrices/macros.tex}
\input{../normal_densities/macros.tex}
\input{../multivariate_real_densities/macros.tex}
\input{../matrix_determinants/macros.tex}
\input{../marginal_densities/macros.tex}
\input{../tree_distribution_approximators/macros.tex}
\input{../differential_relative_entropy/macros.tex}
\input{../tree_densities/macros.tex}
\input{../multivariate_normals/macros.tex}
\input{../conditional_densities/macros.tex}
\input{../tree_density_approximators/macros.tex}
\input{../tree_normals/macros.tex}
\input{../normal_conditionals/macros.tex}
\input{../best_tree_density_approximators/macros.tex}
\input{./macros.tex}
\sstart
\stitle{Tree Normal Approximators}

\ssection{Why}

What is the optimal tree approximator of a multivariate normal density?

\ssection{Result}

\begin{prop}

% TODO: remove language of Chow-Liu tree.
% TODO: define precision matrix

Let $g: \R^n \to \R$ be a normal density with mean $\mu \in \R^d$ and covariance $\Sigma \in \mathbf{S}^d_{++}$.
The normal density $f^*_T: \R^d \to \R$ with mean $\mu$ and precision matrix $P$ defined by
  \begin{itemize}
    \item $P_{11} = \Sigma_{11}^{-1} + \sum_{\pa{j} = 1}
\Sigma_{j1}^2\Sigma_{11}^{-2}\Sigma_{j\mid 1}^{-1}$
      \item for $i = 2, \dots, d$, $P_{ii} = \Sigma_{i\mid\pa{i}}^{-1} + \sum_{\pa{j} = i} \Sigma_{ji}^2\Sigma_{ii}^{-2}\Sigma_{j\mid i}^{-1}$
      \item $i, j = 1, \dots d$ and $i = \pa{j}$, $P_{ij} = P_{ji} = -\Sigma_{ji}\Sigma_{jj}^{-1}\Sigma_{j \mid i}^{-1}$
  \end{itemize}
  where $\pa{i}$ is the parent of $i$ in an optimal approximator tree $T$ ($i = 2, \dots, n)$ is an optimal tree approximator of $g$.

\begin{proof}

Using Proposition 1 of Best Tree Density Approximators, express an optimal tree approximator of $g$ by
$$
(1/c)
\exp\left(
  -\frac{1}{2}
  \left(
    \Sigma_{11}^{-1}\bar{x}_1^2 +
      \sum_{i \neq 1}
            \left(\bar{x}_i - \Sigma_{i,\pa{i}}\Sigma_{\pa{i},\pa{i}}^{-1}\bar{x}_{\pa{i}}\right)^2\Sigma_{i\mid\pa{i}}^{-1}
      \right)
    \right)
$$
where $\bar{x}_i = x_i - \mu_i$ and $c = \sqrt{(2\pi)^d\Sigma_{11} \prod_{i \neq 1} \Sigma_{i \mid \pa{i}}}$.

Second, express the quadratic in the exponential as
$$
  \Sigma_{11}^{-1}\bar{x}_1^2 +
    \sum_{i \neq 1}
    \left[
      \Sigma_{i\mid\pa{i}}^{-1}
      \bar{x}_i^2
      -
      2
      \Sigma_{i,\pa{i}}\Sigma_{\pa{i},\pa{i}}^{-1}\Sigma_{i\mid\pa{i}}^{-1}
      \bar{x}_i\bar{x}_{\pa{i}}
      +
      \Sigma_{i,\pa{i}}^2\Sigma_{\pa{i},\pa{i}}^{-2}\Sigma_{i\mid\pa{i}}^{-1}
      \bar{x}_{\pa{i}}^2
    \right]
$$
With $P$ defined as earlier, we can express the above as $\bar{x}^{\tp} P \bar{x}$.

%% TODO: proof for exponential of quadratic integrating to one
Third, note that $c$ is $\sqrt{(2\pi)^d\det P^{-1}}$ since $f^*_T$ is a density and so integrates to one.

\end{proof}

\end{prop}

Notice that $f^*_T$ is a tree normal density.

\ssection{Empirical Normal}

In particular, notice that we can approximate the empirical normal density of a dataset with a density that factors according to a tree.
\strats
