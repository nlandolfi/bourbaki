\input{../../sheet.tex}
\sbasic
\input{../objects/macros.tex}
\input{../equations/macros.tex}
\input{../sets/macros.tex}
\input{../identity/macros.tex}
\input{../equation_solutions/macros.tex}
\input{../sentences/macros.tex}
\input{../set_equality/macros.tex}
\input{../unordered_pairs/macros.tex}
\input{../integer_numbers/macros.tex}
\input{../empty_set/macros.tex}
\input{../functions/macros.tex}
\input{../set_complements/macros.tex}
\input{../set_specification/macros.tex}
\input{../operations/macros.tex}
\input{../set_inclusion/macros.tex}
\input{../ordered_pairs/macros.tex}
\input{../family_operations/macros.tex}
\input{../arithmetic/macros.tex}
\input{../common_sense/macros.tex}
\input{../injective_functions/macros.tex}
\input{../rational_numbers/macros.tex}
\input{../natural_numbers/macros.tex}
\input{../families/macros.tex}
\input{../natural_addition/macros.tex}
\input{../set_unions/macros.tex}
\input{../set_symmetric_differences/macros.tex}
\input{../set_intersections/macros.tex}
\input{../algebras/macros.tex}
\input{../power_set/macros.tex}
\input{../relations/macros.tex}
\input{../natural_summation/macros.tex}
\input{../probability/macros.tex}
\input{../cardinality/macros.tex}
\input{../real_numbers/macros.tex}
\input{../natural_order/macros.tex}
\input{../natural_families/macros.tex}
\input{../natural_difference/macros.tex}
\input{../set_operations/macros.tex}
\input{../probability_events/macros.tex}
\input{../partial_orders/macros.tex}
\input{../real_summation/macros.tex}
\input{../probability_outcomes/macros.tex}
\input{../intervals/macros.tex}
\input{../direct_products/macros.tex}
\input{../event_probabilities/macros.tex}
\input{../total_orders/macros.tex}
\input{../datasets/macros.tex}
\input{../probability_distributions/macros.tex}
\input{../marginal_distributions/macros.tex}
\input{../conditional_event_probability/macros.tex}
\input{../optimizers/macros.tex}
\input{../distribution_selection/macros.tex}
\input{../distribution_expectation/macros.tex}
\input{../conditional_distributions/macros.tex}
\input{./macros.tex}
\sstart
\stitle{Expectation Maximization}

\ssection{Why}

I am doing a homework on this.

\ssection{Definition}

Let $Z$ and $X$ be non-empty finite sets.
We want to model a distribution
$p^\theta: Z \times X \to \R$.
We parameterize a family
of distributions by a parameter $\theta$.
We have a dataset $(x^1, \dots, x^n)$.
Given a parameter $\theta^0$, we want
to solve
\[
  \maximization{\theta}{\sum_{k = 1}^{n}
    \Expect_{p^{\theta^0}_{z \mid x}(z, x^k)}
    \left[
      \log p^{\theta}(z, x)
    \right]
  }
\]
\subsection{Binary Gaussian Mixture Example}
The

\comment{

\[
  \maximization{\theta}{\sum_{k = 1}^{n} \log p^{\theta}_x(x^k)}
\]
For $k = 1,\dots,n$
we express
\[
  \log p_{x}^{\theta}(x^k) = \sum_{z \in Z} p^\theta(z, x^k) =
  \sum_{z \in Z} p_z^\theta(z)p^\theta_{x\mid z}(x^k, z)
\]
For $k = 1, \dots, n$ let
$q^i: Z \to \R$ be a distribution on $Z$.
Then, for $k = 1\dots,n$ we express
\[
  \log p_{x}^{\theta}(x^i) = \log \left( \Expect_{z \sim q}\left[
    p_{x \mid z}^\theta (x^k, z) \frac{p^{\theta}_z(z)}{q^k(z)}
    \right]
  \right)
\]
We can lower bound this expression using Jensen's inequality
\[
  \log p_{x}^{\theta}(x^k) \geq \Expect_{z \sim q} \left[
    \log \left(p_{x \mid z}^\theta (x^k, z) \frac{p^{\theta}_z(z)}{q^k(z)}\right)
    \right]
\]
Jensen's inequality is tight if $q^k(z) \propto p_{x \mid z}(x^k, z)p_z(z)$
(some argument about it being constant?)
which means (?)
\[
  q^k(z) = p_{z \mid x}(z \mid x^k)
\]
So finally we have
\[
  \log p_{x}^\theta(x^k) \approx \Expect_{z \sim p_{z\mid x}(\cdot, x^k)}
  \left[
    \log p^\theta(z, x^k) - \log p_{z \mid x}^{\theta^0}(z, \mid x_{k})
  \right]
\]
So given $\theta^0$ we will solve
\[
  \maximization{\theta}{ \sum_{k = 1}^{n}
    \Expect_{z \sim p_{x \mid x^k}}
  \left[
    \log p^\theta(z, x^k) - \log p_{z \mid x}^{\theta^0}(z, \mid x_{k})
  \right]
  }
\]
}
\strats
