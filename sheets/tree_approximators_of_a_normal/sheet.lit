<!--
!name:tree_approximators_of_a_normal
!need:optimal_tree_density_approximators
!need:tree_normals
!need:normal_conditionals
-->

Â§ Why â¦‰
Â¶ â¦Š
  â€– What is the optimal tree approximator of a multivariate
    normal density? â¦‰
â¦‰

Â§ Result â¦‰

<!-- TODO: remove language of Chow-Liu tree. -->

<!-- TODO: define precision matrix -->
<statement type='proposition'>
  Â¶ â¦Š
    â€– Let $g: ğ—¥^n â†’ ğ—¥$ be a normal density with mean $Î¼ âˆˆ
      ğ—¥^d$ and covariance $Î£ âˆˆ ğ’^d_{++}$. â¦‰

    â€– The normal density $f^*_T: ğ—¥^d â†’ ğ—¥$ with mean $Î¼$ and
      precision matrix $P$ defined by
      â â¦Š
        â€£ $P_{11} = Î£_{11}^{-1} + âˆ‘_{\pa{j} = 1}
          Î£_{j1}^2Î£_{11}^{-2}Î£_{j|1}^{-1}$ â¦‰

        â€£ for $i = 2, â€¦, d$, $P_{ii} = Î£_{i\mid\pa{i}}^{-1} +
          âˆ‘_{\pa{j} = i} Î£_{ji}^2Î£_{ii}^{-2}Î£_{j|i}^{-1}$ â¦‰

        â€£ $i, j = 1, â€¦ d$ and $i = \pa{j}$, $P_{ij} = P_{ji}
          = -Î£_{ji}Î£_{jj}^{-1}Î£_{j |i}^{-1}$ â¦‰
      â¦‰
      where $\pa{i}$ is the parent of $i$ in an optimal
      approximator tree $T$ ($i = 2, â€¦, n)$ is an optimal tree
      approximator of $g$. â¦‰
  â¦‰
</statement>
<proof>
  Â¶ â¦Š
    â€– Using Proposition 1 of Best Tree Density Approximators,
      express an optimal tree approximator of $g$ by
      â—‡ â¦Š
        â€– (1/c) â¦‰

        â€– \exp\left( â¦‰

        â€– -\frac{1}{2} â¦‰

        â€– \left( â¦‰

        â€– Î£_{11}^{-1}\bar{x}_1^2 + â¦‰

        â€– âˆ‘_{i â‰  1} â¦‰

        â€– \left(\bar{x}_i -
          Î£_{i,\pa{i}}Î£_{\pa{i},\pa{i}}^{-1}\bar{x}_{\pa{i}}\right)^2Î£_{i\mid\pa{i}}^{-1} â¦‰

        â€– \right) â¦‰

        â€– \right) â¦‰
      â¦‰
      where $\bar{x}_i = x_i - Î¼_i$ and $c = âˆš{(2Ï€)^dÎ£_{11}
      âˆ_{i â‰  1} Î£_{i |\pa{i}}}$. â¦‰
  â¦‰

  Â¶ â¦Š
    â€– Second, express the quadratic in the exponential as
      â—‡ â¦Š
        â€– Î£_{11}^{-1}\bar{x}_1^2 + â¦‰

        â€– âˆ‘_{i â‰  1} â¦‰

        â€– \left[ â¦‰

        â€– Î£_{i\mid\pa{i}}^{-1} â¦‰

        â€– \bar{x}_i^2 â¦‰

        â€– - â¦‰

        â€– 2 â¦‰

        â€– Î£_{i,\pa{i}}Î£_{\pa{i},\pa{i}}^{-1}Î£_{i\mid\pa{i}}^{-1} â¦‰

        â€– \bar{x}_i\bar{x}_{\pa{i}} â¦‰

        â€– + â¦‰

        â€– Î£_{i,\pa{i}}^2Î£_{\pa{i},\pa{i}}^{-2}Î£_{i\mid\pa{i}}^{-1} â¦‰

        â€– \bar{x}_{\pa{i}}^2 â¦‰

        â€– \right] â¦‰
      â¦‰â¦‰

    â€– With $P$ defined as earlier, we can express the above as
      $\bar{x}^{\tp} P \bar{x}$. â¦‰
  â¦‰

  Â¶ â¦Š
    <!--TODO: proof for exponential of quadratic integrating to one -->

    â€– Third, note that $c$ is $âˆš{(2Ï€)^d\det P^{-1}}$ since
      $f^*_T$ is a density and so integrates to one. â¦‰
  â¦‰
</proof>
Â¶ â¦Š
  â€– Notice that $f^*_T$ is a tree normal density. â¦‰
â¦‰

Â§ Empirical normal â¦‰
Â¶ â¦Š
  â€– In particular, notice that we can approximate the empirical
    normal density of a dataset with a density that factors
    according to a tree. â¦‰
â¦‰
