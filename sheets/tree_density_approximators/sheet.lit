<!--
!name:tree_density_approximators
!need:tree_densities
!need:tree_distribution_approximators
!need:differential_relative_entropy
-->

Â§ Why â¦‰
Â¶ â¦Š
  â€– We can approximate a density with a tree density similar to
    how we can approximate a distribution with a tree
    distribution. â¦‰
â¦‰

Â§ Definition â¦‰
Â¶ â¦Š
  â€– We use the differential relative entropy as a criterion of
    approximation. â¦‰

  â€– An â¬optimal tree approximatorâ­ of density for a tree is a
    density which factors according to a tree and minimizes its
    differential relative entropy with the given density. â¦‰
â¦‰

Â§ Notation â¦‰
Â¶ â¦Š
  â€– Let $g: ğ—¥^n â†’ ğ—¥$ be a density and $T$ be a tree on
    $\set{1, â€¦, n}$. â¦‰

  â€– An optimal tree approximator of $g$ for $T$ is a density
    $f$ that factors according to $T$ and minimizes $d(g, f)$. â¦‰

  â€– In other words, given $g$ and $T$ we want to find $f$ to
    â—‡ â¦Š
      â€– \begin{aligned} â¦‰

      â€– \text{minimize} ï¼†\quad d(g, f) áœ¶ â¦‰

      â€– \text{subject to} ï¼†\quad f \text{ factors according to }
        T. â¦‰

      â€– \end{aligned} â¦‰
    â¦‰â¦‰

  Â§ Result â¦‰
â¦‰

<statement type='proposition'>
  Â¶ â¦Š
    â€– Let $g: ğ—¥^n â†’ ğ—¥$ be a density and $T$ be a tree on
      $\set{1, â€¦, n}$. â¦‰

    â€– The density $f^*_T: ğ—¥^d â†’ ğ—¥$ defined by â¦‰

    â€– $$ â¦‰

    â€– f^*_T = g_1 âˆ_{i â‰  1} g_{i |\pa{i}} â¦‰

    â€– $$ â¦‰

    â€– minimizes the differential relative entropy with $g$ among
      all densities on $ğ—¥^n$ which factor according to $T$
      ($\pa{i}$ is the parent of $i$ in $T$ rooted at vertex
      $1$, $i = 2, â€¦, n$). â¦‰
  â¦‰
</statement>
<proof>
  Â¶ â¦Š
    â€– Let $f: ğ—¥^d â†’ ğ—¥$ be a density factoring according to $T$. â¦‰

    â€– First, express
      â—‡ â¦Š
        â€– f = f_1 âˆ_{i = 1} f_{i |\pa{i}}. â¦‰
      â¦‰â¦‰
  â¦‰

  Â¶ â¦Š
    â€– Second, recall that $d(g, f) = h(g, f) - h(g)$. â¦‰

    â€– Since $h(g)$ does not depend on $f$, $f$ is a minimizer
      of $d(g, f)$ if and only if $f$ is a minimizer of $h(g,
      f)$. â¦‰
  â¦‰

  Â¶ â¦Š
    â€– Third, express
      â—‡ â¦Š
        â€– \begin{aligned} â¦‰

        â€– h(g, f) &= - âˆˆt_{ğ—¥^d} g \log f áœ¶ â¦‰

        â€– &= - âˆˆt_{ğ—¥^d} g(x) \parens*{ \log f_{i}(x_i) + âˆ‘_{i â‰ 
          1} \log f_{i |\pa{i}}(x_i, x_{\pa{i}})} dx áœ¶ â¦‰

        â€– &= h(g_1, f_1) + âˆ‘_{i â‰  1} \parens*{ âˆˆt_{ğ—¥}
          g_{\pa{i}}(Î¾) h\parens*{g_{i |\pa{i}}(Â·, Î¾),
          f_{i\mid\pa{i}}(Â·,Î¾)}dÎ¾} â¦‰

        â€– \end{aligned} â¦‰
      â¦‰
      which separates across $f_1$ and $f_{i |\pa{i}}(Â·, Î¾)$ for
      $i = 1, â€¦, n$ and $Î¾ âˆˆ ğ—¥$. â¦‰

    â€– In particular, since $g_{pa{i}} â‰¥ 0$, we can minimize the
      integrand pointwise. â¦‰
  â¦‰

  Â¶ â¦Š
    â€– Fourth, recall $h(Ï†, Ïˆ) â‰¥ 0$ for densities $Ï†, Ïˆ$ of any
      dimension, and zero if $Ï† = Ïˆ$. â¦‰

    â€– So $f_1 = g_1$ and $f_{i |\pa{i}} = g_{i |\pa{i}}$ are
      solutions. â¦‰
  â¦‰
</proof>

<!--
% relative entropy.
% We want to
% \[
%   \minimizationn{
%     \text{ density } f \text{ and tree } T \text{ on } \set{1, \dots, n}
%   }{
%     d(g, f)
%   }{
%     f \text{ factors according to } T.
%   }
% \]
-->
