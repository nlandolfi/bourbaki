\input{../../sheet.tex}
\sbasic
\input{../subset_systems/macros.tex}
\input{../real_functions/macros.tex}
\input{../subset_algebras/macros.tex}
\input{../objects/macros.tex}
\input{../identity/macros.tex}
\input{../equations/macros.tex}
\input{../partitions/macros.tex}
\input{../characteristic_functions/macros.tex}
\input{../measures/macros.tex}
\input{../ordered_pairs/macros.tex}
\input{../sets/macros.tex}
\input{../set_equality/macros.tex}
\input{../equation_solutions/macros.tex}
\input{../simple_functions/macros.tex}
\input{../measurable_functions/macros.tex}
\input{../relations/macros.tex}
\input{../sentences/macros.tex}
\input{../set_complements/macros.tex}
\input{../operations/macros.tex}
\input{../set_inclusion/macros.tex}
\input{../empty_set/macros.tex}
\input{../functions/macros.tex}
\input{../zero/macros.tex}
\input{../simple_integrals/macros.tex}
\input{../families/macros.tex}
\input{../partial_orders/macros.tex}
\input{../set_specification/macros.tex}
\input{../unordered_pairs/macros.tex}
\input{../set_symmetric_differences/macros.tex}
\input{../set_intersections/macros.tex}
\input{../algebras/macros.tex}
\input{../power_set/macros.tex}
\input{../natural_sums/macros.tex}
\input{../family_operations/macros.tex}
\input{../common_sense/macros.tex}
\input{../natural_numbers/macros.tex}
\input{../injective_functions/macros.tex}
\input{../integer_numbers/macros.tex}
\input{../nonnegative_integrals/macros.tex}
\input{../natural_order/macros.tex}
\input{../natural_families/macros.tex}
\input{../natural_differences/macros.tex}
\input{../total_orders/macros.tex}
\input{../set_unions/macros.tex}
\input{../graphs/macros.tex}
\input{../set_operations/macros.tex}
\input{../probability_events/macros.tex}
\input{../length_common_notions/macros.tex}
\input{../natural_summation/macros.tex}
\input{../probability/macros.tex}
\input{../cardinality/macros.tex}
\input{../rational_numbers/macros.tex}
\input{../real_integrals/macros.tex}
\input{../space/macros.tex}
\input{../direct_products/macros.tex}
\input{../optimizers/macros.tex}
\input{../trees/macros.tex}
\input{../marginal_distributions/macros.tex}
\input{../event_probabilities/macros.tex}
\input{../distance/macros.tex}
\input{../real_summation/macros.tex}
\input{../probability_outcomes/macros.tex}
\input{../intervals/macros.tex}
\input{../real_numbers/macros.tex}
\input{../probability_densities/macros.tex}
\input{../n-dimensional_space/macros.tex}
\input{../datasets/macros.tex}
\input{../real_optimizers/macros.tex}
\input{../rooted_trees/macros.tex}
\input{../conditional_distributions/macros.tex}
\input{../marginal_densities/macros.tex}
\input{../conditional_event_probability/macros.tex}
\input{../metrics/macros.tex}
\input{../probability_distributions/macros.tex}
\input{../logarithm/macros.tex}
\input{../multivariate_real_densities/macros.tex}
\input{../empirical_distribution/macros.tex}
\input{../approximators/macros.tex}
\input{../rooted_tree_distributions/macros.tex}
\input{../conditional_densities/macros.tex}
\input{../similarity_functions/macros.tex}
\input{../entropy/macros.tex}
\input{../cross_entropy/macros.tex}
\input{../differential_entropy/macros.tex}
\input{../tree_distributions/macros.tex}
\input{../distribution_approximators/macros.tex}
\input{../rooted_tree_densities/macros.tex}
\input{../relative_entropy/macros.tex}
\input{../differential_cross_entropy/macros.tex}
\input{../tree_distribution_approximators/macros.tex}
\input{../tree_densities/macros.tex}
\input{../differential_relative_entropy/macros.tex}
\input{./macros.tex}
\sstart
\stitle{Tree Density Approximators}

\ssection{Why}

We can approximate a density with a tree density similar to how we can approximate a distribution with a tree distribution.

\ssection{Definition}

We use the differential relative entropy as a criterion of approximation.
An \t{optimal tree approximator} of density for a tree is a density which factors according to a tree and minimizes its differential relative entropy with the given density.

\ssection{Notation}

Let $g: \R^n \to \R$ be a density and $T$ be a tree on $\set{1, \dots, n}$.
An optimal tree approximator of $g$ for $T$ is a density $f$ that factors according to $T$ and minimizes $d(g, f)$.
In other words, given $g$ and $T$ we want to find $f$ to
\[
  \begin{aligned}
    \text{minimize}   &\quad d(g, f) \\
    \text{subject to} &\quad f \text{ factors according to } T.
  \end{aligned}
\]

\ssection{Result}

\begin{prop}

Let $g: \R^n \to \R$ be a density and $T$ be a tree on $\set{1, \dots, n}$.
The density $f^*_T: \R^d \to \R$ defined by
$$
  f^*_T = g_1 \prod_{i \neq 1} g_{i \mid \pa{i}}
$$
minimizes the differential relative entropy with $g$ among all densities on $\R^n$ which factor according to $T$ ($\pa{i}$ is the parent of $i$ in $T$ rooted at vertex $1$, $i = 2, \dots, n$).

\begin{proof}

Let $f: \R^d \to \R$ be a density factoring according to $T$.
First, express
$$
  f = f_1 \prod_{i = 1} f_{i \mid \pa{i}}.
$$

Second, recall that $d(g, f) = h(g, f) - h(g)$.
Since $h(g)$ does not depend on $f$, $f$ is a minimizer of $d(g, f)$ if and only if $f$ is a minimizer of $h(g, f)$.

Third, express
$$
\begin{aligned}
  h(g, f) &= - \int_{\R^d} g \log f \\
          &= - \int_{\R^d} g(x) \parens*{ \log f_{i}(x_i) + \sum_{i \neq 1} \log f_{i \mid \pa{i}}(x_i, x_{\pa{i}})} dx \\
          &= h(g_1, f_1) + \sum_{i \neq 1} \parens*{ \int_{\R} g_{\pa{i}}(\xi) h\parens*{g_{i \mid \pa{i}}(\cdot, \xi), f_{i\mid\pa{i}}(\cdot,\xi)}d\xi}
\end{aligned}
$$
which separates across $f_1$ and $f_{i \mid \pa{i}}(\cdot, \xi)$ for $i = 1, \dots, n$ and $\xi \in \R$.
In particular, since $g_{pa{i}} \geq 0$,
we can minimize the integrand pointwise.

Fourth, recall $h(\phi, \psi) \geq 0$ for densities $\phi, \psi$ of any dimension, and zero if $\phi = \psi$.
So $f_1 = g_1$ and $f_{i \mid \pa{i}} = g_{i \mid \pa{i}}$ are solutions.

\end{proof}

\end{prop}

% relative entropy.
% We want to
% \[
%   \minimizationn{
%     \text{ density } f \text{ and tree } T \text{ on } \set{1, \dots, n}
%   }{
%     d(g, f)
%   }{
%     f \text{ factors according to } T.
%   }
% \]
\strats
