<!--yaml
name: featurized_probabilistic_linear_models
needs:
    - normal_linear_model_regressors
    - feature_maps
-->

Â§ Why â¦‰
Â¶ â¦Š
  â€– It is natural to embed a dataset. â¦‰
â¦‰

Â§ Definition â¦‰
Â¶ â¦Š
  â€– Let $(x: Î© â†’ ğ—¥^d, A âˆˆ ğ—¥^{n Ã—d}, e: Î© â†’ ğ—¥^n)$ be a
    probabilistic linear model over the probability space $(Î©, ğ’œ,
    ğ—£)$. â¦‰

  â€– Let $Ï†: ğ—¥^d â†’ ğ—¥^{d'}$ be a feature map. â¦‰
â¦‰

Â¶ â¦Š
  â€– We call the sequence $(x, A, e, Ï†)$ a â¬featurized
    probabilistic linear modelâ­ (also â¬embedded probabilistic linear
    modelâ­). â¦‰

  â€– We interpret the model as a random field $h: Î© â†’ (ğ—¥^d â†’
    ğ—¥)$ which is a linear function of the features
    â—‡ â¦Š
      â€– h_{Ï‰}(a) = \transpose{Ï†(a)}x(Ï‰). â¦‰
    â¦‰â¦‰
â¦‰

Â¶ â¦Š
  â€– Denote the data matrix of the embedded feature vectors by
    $Ï†(A)$. â¦‰

  â€– In other words, $Ï†(A) âˆˆ ğ—¥^{n Ã—d'}$ is a matrix whose rows
    are feature vectors. â¦‰

  â€– Then $(x, A, e, Ï†)$ corresponds to the probabilistic linear
    model $(x, Ï†(A), e)$. â¦‰
â¦‰

Â§ Normal case â¦‰
Â¶ â¦Š
  â€– In the normal (Gaussian) case, the parameter posterior $g_{x
    |y}(Â·, Î³)$ is a normal density with mean
    â—‡ â¦Š
      â€– Î£_{x}\transpose{Ï†(A)}\inv{(Ï†(A)Î£_{x}\transpose{Ï†(A)} + Î£_{e})}
        Î³ â¦‰
    â¦‰
    and covariance
    â—‡ â¦Š
      â€– \inv{(\inv{Î£_{x}} + \transpose{Ï†(A)}\inv{Î£_{e}}Ï†(A))}. â¦‰
    â¦‰â¦‰
  Â¶ â¦Š
    â€– The predictive density for $a âˆˆ ğ—¥^d$ is normal with mean
      â—‡ â¦Š
        â€– \transpose{Ï†(a)}Î£_{x}\transpose{Ï†(A)}\inv{(Ï†(A)Î£_{x}\transpose{Ï†(A)}
          + Î£_{e})}Î³. â¦‰
      â¦‰
      and covariance
      â—‡ â¦Š
        â€– \transpose{Ï†_a}Î£_{x}Ï†_a -
          \transpose{Ï†_a}Î£_{x}\transpose{Ï†(A)}\inv{(Ï†(A)Î£_{x}\transpose{Ï†(A)}
          + Î£_e)}Ï†(A)Î£_{x}Ï†_a. â¦‰
      â¦‰â¦‰
  â¦‰

  Â¶ â¦Š
    â€– So the â¬featurized linear regressorâ­ is the predictor $h:
      ğ—¥^d â†’ ğ—¥$ defined by
      â—‡ â¦Š
        â€– h(a) =
          \transpose{Ï†(a)}Î£_{x}\transpose{Ï†(A)}\inv{(Ï†(A)Î£_{x}\transpose{Ï†(A)}
          + Î£_{e})}Î³. â¦‰
      â¦‰â¦‰
  â¦‰
â¦‰

<tex>
  â€– \blankpage â¦‰
</tex>