\input{../../sheet.tex}
\sbasic
\input{../identity/macros.tex}
\input{../objects/macros.tex}
\input{../equations/macros.tex}
\input{../set_equality/macros.tex}
\input{../sets/macros.tex}
\input{../set_complements/macros.tex}
\input{../operations/macros.tex}
\input{../equation_solutions/macros.tex}
\input{../ordered_pairs/macros.tex}
\input{../set_inclusion/macros.tex}
\input{../sentences/macros.tex}
\input{../set_symmetric_differences/macros.tex}
\input{../algebras/macros.tex}
\input{../set_intersections/macros.tex}
\input{../empty_set/macros.tex}
\input{../power_set/macros.tex}
\input{../functions/macros.tex}
\input{../zero/macros.tex}
\input{../relations/macros.tex}
\input{../set_specification/macros.tex}
\input{../unordered_pairs/macros.tex}
\input{../set_operations/macros.tex}
\input{../probability_events/macros.tex}
\input{../family_operations/macros.tex}
\input{../common_sense/macros.tex}
\input{../injective_functions/macros.tex}
\input{../natural_numbers/macros.tex}
\input{../families/macros.tex}
\input{../natural_sums/macros.tex}
\input{../integer_numbers/macros.tex}
\input{../partial_orders/macros.tex}
\input{../set_unions/macros.tex}
\input{../graphs/macros.tex}
\input{../event_probabilities/macros.tex}
\input{../length_common_notions/macros.tex}
\input{../natural_summation/macros.tex}
\input{../probability/macros.tex}
\input{../cardinality/macros.tex}
\input{../natural_order/macros.tex}
\input{../natural_families/macros.tex}
\input{../natural_differences/macros.tex}
\input{../rational_numbers/macros.tex}
\input{../total_orders/macros.tex}
\input{../trees/macros.tex}
\input{../marginal_distributions/macros.tex}
\input{../conditional_event_probability/macros.tex}
\input{../distance/macros.tex}
\input{../real_summation/macros.tex}
\input{../probability_outcomes/macros.tex}
\input{../intervals/macros.tex}
\input{../direct_products/macros.tex}
\input{../real_numbers/macros.tex}
\input{../optimizers/macros.tex}
\input{../rooted_trees/macros.tex}
\input{../conditional_distributions/macros.tex}
\input{../metrics/macros.tex}
\input{../logarithm/macros.tex}
\input{../probability_distributions/macros.tex}
\input{../datasets/macros.tex}
\input{../real_optimizers/macros.tex}
\input{../rooted_tree_distributions/macros.tex}
\input{../similarity_functions/macros.tex}
\input{../entropy/macros.tex}
\input{../cross_entropy/macros.tex}
\input{../empirical_distribution/macros.tex}
\input{../approximators/macros.tex}
\input{../tree_distributions/macros.tex}
\input{../relative_entropy/macros.tex}
\input{../distribution_approximators/macros.tex}
\input{./macros.tex}
\sstart
\stitle{Tree Distribution Approximators}

\ssection{Why}

We approximate a distribution with a distribution that factors according to a given tree.
Such a distribution requires tabulating fewer numbers to express the probability of outcome.

\ssection{Definition}

We will use the relative entropy as a criterion of approximation.
Given a distribution over a product of finite sets and a tree, we want to find the optimal approximator among distributions which factor according to the tree.
We call such a distribution a \t{tree distribution approximator} or \t{tree approximator} of the given distribution for the tree.
We call the tree the \t{approximator tree}.

\ssection{Result}

\begin{prop}

Let $A_1, \dots, A_n$ be finite non-empty sets.
Define $A = \prod_{i = 1}^{n} A_i$.
Let $q: A \to [0, 1]$ a distribution and $T$ a tree on $\set{1, \dots, n}$.
The distribution $p^*_T: A \to [0, 1]$ defined by
$$
  p^*_T = q_1 \prod_{i \neq 1} q_{i \mid \pa{i}}
$$
minimizes the relative entropy with $q$ among all distributions on $A$ which factor according to $T$.

\begin{proof}

Let $p: A \to [0, 1]$ be a distribution which factors according to $T$.
First, express
$$
  p = p_1 \prod_{i \neq i} p_{i \mid \pa{i}}
$$
where $\pa{i}$ is the parent of vertex $i$ in $T$ rooted at vertex 1 ($i = 2, \dots, n$).

Second, recall that the relative entropy of $q$ with $p$ is $H(q, p) - H(q)$.
Since $H(q)$ does not depend on $p$, $p$ is a minimizer of the relative of $q$ with $p$ if and only if $p$ is a minimizer of $H(q, p)$.

Third, express
$$
\begin{aligned}
  H(q, p) &= - \sum_{a \in A} q(a) \log p(a) \\
          &= - \sum_{a \in A} q(a) \parens*{\log p_1(a_1) + \sum_{i \neq 1} \log p_{i \mid \pa{i}}\parens*{a_i, a_{\pa{i}}}} \\
          &= H(q_1, p_1) + \sum_{i \neq 1} \sum_{a_{\pa{i}} \in A_{\pa{i}}} q_{\pa{i}}(a_{\pa{i}})H\parens*{q_{i\mid\pa{i}}(\cdot, a_{\pa{i}}), p_{i\mid\pa{i}}(\cdot, a_{\pa{i}})}
\end{aligned}
$$
which separates across $p_1$ an $p_{i \mid \pa{i}}(\cdot, a_{\pa{i}})$ for $i = 2, \dots, n$ and $a_{pa_{i}} \in A_{\pa{i}}$.

Fourth, recall $H(\cdot, \cdot) \geq 0$ and is zero on repeated pairs.
By this, we mean, for example, $H(p_1, p_1) = 0$.
So $p_1 = q_1$ and $p_{i \mid \pa{i}} = q_{i \mid \pa{i}}$ are solutions.

\end{proof}

\label{prop:treeapproximators}
\end{prop}

Proposition~\ref{prop:treeapproximators} states the form of an optimal approximator given a tree.
A natural next question is to select the tree.



% Given $q: A \to [0, 1]$ want to find a distribution $p$ on $A$ and tree $T$ on $\set{1, \dots, n}$ to
% \[
%   \begin{aligned}
%     \text{minimize}   &\quad d(q, p) \\
%     \text{subject to} &\quad p \text{ factors according to the tree } T
%   \end{aligned}
% \]
%
\strats
