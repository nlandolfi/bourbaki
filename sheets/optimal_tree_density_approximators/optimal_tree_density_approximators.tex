\input{../../sheet.tex}
\sbasic
\input{../subset_systems/macros.tex}
\input{../real_functions/macros.tex}
\input{../subset_algebras/macros.tex}
\input{../objects/macros.tex}
\input{../partitions/macros.tex}
\input{../characteristic_functions/macros.tex}
\input{../measures/macros.tex}
\input{../sentences/macros.tex}
\input{../sets/macros.tex}
\input{../identity/macros.tex}
\input{../equations/macros.tex}
\input{../simple_functions/macros.tex}
\input{../measurable_functions/macros.tex}
\input{../set_specification/macros.tex}
\input{../relation_properties/macros.tex}
\input{../ordered_pairs/macros.tex}
\input{../set_equality/macros.tex}
\input{../equation_solutions/macros.tex}
\input{../simple_integrals/macros.tex}
\input{../families/macros.tex}
\input{../operations/macros.tex}
\input{../functions/macros.tex}
\input{../partial_orders/macros.tex}
\input{../relations/macros.tex}
\input{../natural_order/macros.tex}
\input{../natural_families/macros.tex}
\input{../algebras/macros.tex}
\input{../set_inclusion/macros.tex}
\input{../integer_numbers/macros.tex}
\input{../nonnegative_integrals/macros.tex}
\input{../family_operations/macros.tex}
\input{../arithmetic/macros.tex}
\input{../common_sense/macros.tex}
\input{../natural_numbers/macros.tex}
\input{../injective_functions/macros.tex}
\input{../total_orders/macros.tex}
\input{../graphs/macros.tex}
\input{../direct_products/macros.tex}
\input{../set_operations/macros.tex}
\input{../probability_events/macros.tex}
\input{../length_common_notions/macros.tex}
\input{../rational_numbers/macros.tex}
\input{../real_integrals/macros.tex}
\input{../space/macros.tex}
\input{../natural_summation/macros.tex}
\input{../probability/macros.tex}
\input{../cardinality/macros.tex}
\input{../optimizers/macros.tex}
\input{../trees/macros.tex}
\input{../marginal_distributions/macros.tex}
\input{../event_probabilities/macros.tex}
\input{../distance/macros.tex}
\input{../real_numbers/macros.tex}
\input{../probability_densities/macros.tex}
\input{../n-dimensional_space/macros.tex}
\input{../real_summation/macros.tex}
\input{../probability_outcomes/macros.tex}
\input{../intervals/macros.tex}
\input{../real_optimizers/macros.tex}
\input{../rooted_trees/macros.tex}
\input{../conditional_distributions/macros.tex}
\input{../marginal_densities/macros.tex}
\input{../conditional_event_probability/macros.tex}
\input{../metrics/macros.tex}
\input{../logarithm/macros.tex}
\input{../multivariate_real_densities/macros.tex}
\input{../probability_distributions/macros.tex}
\input{../approximators/macros.tex}
\input{../rooted_tree_distributions/macros.tex}
\input{../conditional_densities/macros.tex}
\input{../similarity_functions/macros.tex}
\input{../entropy/macros.tex}
\input{../cross_entropy/macros.tex}
\input{../differential_entropy/macros.tex}
\input{../tree_distributions/macros.tex}
\input{../distribution_approximators/macros.tex}
\input{../rooted_tree_densities/macros.tex}
\input{../relative_entropy/macros.tex}
\input{../differential_cross_entropy/macros.tex}
\input{../tree_distribution_approximators/macros.tex}
\input{../tree_densities/macros.tex}
\input{../differential_relative_entropy/macros.tex}
\input{../tree_density_approximators/macros.tex}
\input{./macros.tex}
\sstart
\stitle{Optimal Tree Density Approximators}

\ssection{Why}

Which is the optimal tree to use for tree density approximation?

\ssection{Definition}

We want to choose the tree whose corresponding approximator for the given density achieves minimum relative entropy with the given density among all tree density approximators.
We call such a density an \t{optimal tree approximator} of the given density.
We call a tree according to which an optimal tree approximator factors and optimal approximator tree.

\ssection{Result}

\begin{prop}

Let $g: \R^n \to [0, 1]$ be a density.
A tree $T$ on $\set{1, \dots, n}$ is an optimal approximator tree if and only if it is a maximal spanning tree of the differential mutual information graph of $q$.

\begin{proof}
First, denote the optimal approximator of $g$ for tree $T$ by $f^*_T$. Recall
$$
  f^*_T = f_1 \prod_{i \neq 1} f_{i \mid \pa{i}}
$$

Second, recall $d(g, f) = H(g, f) - H(g)$.
Since $H(g)$ does not depend on $f$, $f$ is a minimizer of $d(g, f)$ if and only if it is a minimizer of $H(g, f)$.

Third, express the cross entropy of $f^*_T$ relative to $g$ as
$$
\begin{aligned}
  H(q, p^*_T) &= h(q_1) - \sum_{j \neq i} \parens*{ \int_{\R^d} g(x) \log g_{i \mid pa{i}}(x_i, x_{\pa{i}}) dx } \\
              &= H(q_1) - \sum_{i \neq 1} \sum_{a \in A} q(a)\parens{\log q_{i,\pa{i}}(a_i, a_{\pa{i}}) - \log q_{\pa{i}}(a_{\pa{i}})} \\
              &= H(q_1) - \sum_{i \neq 1} \sum_{a \in A} q(a)\parens{\log q_{i,\pa{i}}(a_i, a_{\pa{i}}) - \log q_{\pa{i}}(a_{\pa{i}}) - \log q_i(a_i)  + \log q_{i}(a_i)} \\
              &= \sum_{i = 1}^{n} H(q_i) - \sum_{i \neq 1} I(q_i, q_{\pa{i}}) \\
              &= \sum_{i = 1}^{n} H(q_i) - \sum_{\set{i,j} \in T} I(q_i, q_{j}) \\
\end{aligned}
$$
where $\pa{i}$ denotes the parent of vertex $i$ in $T$ ($i = 2, \dots, n$).
$H(g_i)$ does not depend on the choice of tree.
Choosing a tree to minimize the second term in the final expression above is equivalent to choosing a maximal spanning tree from the weighted graph with differential mutual information edge weights; namely, the mutual information graph of $g$.

\end{proof}

\end{prop}
\strats
