<!--
!name:optimal_tree_density_approximators
!need:tree_density_approximators
-->

¬ß Why ‚¶â
¬∂ ‚¶ä
  ‚Äñ Which is the optimal tree to use for tree density
    approximation? ‚¶â
‚¶â

¬ß Definition ‚¶â
¬∂ ‚¶ä
  ‚Äñ We want to choose the tree whose corresponding approximator
    for the given density achieves minimum relative entropy with
    the given density among all tree density approximators. ‚¶â

  ‚Äñ We call such a density an ‚ù¨optimal tree approximator‚ù≠ of
    the given density. ‚¶â

  ‚Äñ We call a tree according to which an optimal tree
    approximator factors and optimal approximator tree. ‚¶â
‚¶â

¬ß Result ‚¶â
<statement type='proposition'>
  ¬∂ ‚¶ä
    ‚Äñ Let $g: ùó•^n ‚Üí [0, 1]$ be a density. ‚¶â

    ‚Äñ A tree $T$ on $\set{1, ‚Ä¶, n}$ is an optimal approximator
      tree if and only if it is a maximal spanning tree of the
      differential mutual information graph of $q$. ‚¶â
  ‚¶â

  <proof>
    ¬∂ ‚¶ä
      ‚Äñ First, denote the optimal approximator of $g$ for tree
        $T$ by $f^*_T$. Recall
        ‚óá ‚¶ä
          ‚Äñ f^*_T = f_1 ‚àè_{i ‚â† 1} f_{i | \pa{i}} ‚¶â
        ‚¶â‚¶â
    ‚¶â

    ¬∂ ‚¶ä
      ‚Äñ Second, recall $d(g, f) = H(g, f) - H(g)$. ‚¶â

      ‚Äñ Since $H(g)$ does not depend on $f$, $f$ is a minimizer
        of $d(g, f)$ if and only if it is a minimizer of $H(g,
        f)$. ‚¶â
    ‚¶â

    ¬∂ ‚¶ä
      ‚Äñ Third, express the cross entropy of $f^*_T$ relative to
        $g$ as
        ‚óá ‚¶ä
          ‚Äñ \begin{aligned} ‚¶â

          ‚Äñ H(q, p^*_T) ÔºÜ= h(q_1) - ‚àë_{j ‚â† i} ( \int_{ùó•^d} g(x)
            \log g_{i | \pa_i}(x_i, x_{\pa_i}) dx ) ·ú∂ ‚¶â

          ‚Äñ ÔºÜ= H(q_1) - ‚àë_{i ‚â† 1} ‚àë_{a ‚àà A} q(a) (\log
            q_{i,\pa_i}(a_i, a_{\pa_i}) - \log q_{\pa{i}}(a_{\pa_i}))
            ·ú∂ ‚¶â

          ‚Äñ ÔºÜ= H(q_1) - ‚àë_{i ‚â† 1} ‚àë_{a ‚àà A} q(a) (\log
            q_{i,\pa_i}(a_i, a_{\pa_i}) - \log q_{\pa_i}(a_{\pa_i}) -
            \log q_i(a_i) + \log q_{i}(a_i) ) ·ú∂ ‚¶â

          ‚Äñ ÔºÜ= ‚àë_{i = 1}^{n} H(q_i) - ‚àë_{i ‚â† 1} I(q_i,
            q_{\pa_i}) ·ú∂ ‚¶â

          ‚Äñ ÔºÜ= ‚àë_{i = 1}^{n} H(q_i) - ‚àë_{\set{i,j} ‚àà T} I(q_i,
            q_{j}) ·ú∂ ‚¶â

          ‚Äñ \end{aligned} ‚¶â
        ‚¶â
        where $\pa_i$ denotes the parent of vertex $i$ in $T$
        ($i = 2, ‚Ä¶, n$). ‚¶â

      ‚Äñ $H(g_i)$ does not depend on the choice of tree. ‚¶â

      ‚Äñ Choosing a tree to minimize the second term in the
        final expression above is equivalent to choosing a maximal
        spanning tree from the weighted graph with differential
        mutual information edge weights; namely, the mutual
        information graph of $g$. ‚¶â
    ‚¶â
  </proof>
</statement>
