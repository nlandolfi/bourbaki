<!--
!name:projections_on_affine_sets
!need:real_affine_set_representations
!need:real_vector_projections
!need:projections_on_subspaces
!need:real_matrix_range
-->

§ Why ⦉
¶ ⦊
  ‖ What is the projection of a vector onto an affine set? ⦉
⦉

§ Result ⦉
¶ ⦊
  ‖ \begin{proposition} ⦉

  ‖ Suppose $a ∈ 𝗥^n$ and $U ∈ 𝗥^{n × k}$ with $U^⊤U = I$. ⦉

  ‖ Define the affine set $W(a, U) = a + \range(U)$. ⦉

  ‖ Then
    ◇ ⦊
      ‖ \textstyle ⦉

      ‖ \proj_{W(a, U)}(x) = UU^⊤x + (I - UU^⊤)a. ⦉
    ⦉⦉

  ‖ \end{proposition} ⦉

  ‖ \begin{proof} ⦉

  ‖ The minimizer of $J: 𝗥^n → 𝗥$ defined by
    ◇ ⦊
      ‖ J(z) = \norm{a + Uz - x} = \norm{Uz - (x -a)}, ⦉
    ⦉
    is $z^★ = U^⊤(x-a)$. ⦉

  ‖ So the projection of $x$ onto $W(a, U)$ is
    ◇ ⦊
      ‖ a + Uz^★ = a + UU^⊤(x - a) = UU^⊤x + (I - UU^⊤)a. ⦉
    ⦉⦉

  ‖ \end{proof} ⦉
⦉

<tex>
  ‖ \blankpage ⦉
</tex>
