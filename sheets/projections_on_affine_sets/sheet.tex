%!name:projections_on_affine_sets
%!need:real_affine_set_representations
%!need:real_vector_projections
%!need:projections_on_subspaces
%!need:real_matrix_range

\section*{Why}

What is the projection of a vector onto an affine set?

\section*{Result}

\begin{proposition}
Suppose $a \in \R ^n$ and $U \in \R ^{n \times  k}$ with $U^\top U = I$.
Define the affine set $W(a, U) = a + \range(U)$.
Then
  \[
\textstyle
\proj_{W(a, U)}(x) = UU^\top x + (I - UU^\top )a.
  \]
\end{proposition}
\begin{proof}
The minimizer of $J: \R ^n \to \R $ defined by
  \[
J(z) = \norm{a + Uz - x} = \norm{Uz - (x -a)},
  \]
is $z^\star = U^\top (x-a)$.
So the projection of $x$ onto $W(a, U)$ is
  \[
a + Uz^\star = a + UU^\top (x - a) = UU^\top x + (I - UU^\top )a.
  \]
\end{proof}

\blankpage