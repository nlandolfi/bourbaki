<!--yaml
name: normal_random_function_predictive_densities
needs:
    - normal_random_functions
    - affine_transformations
-->

Â§ Why â¦‰
Â¶ â¦Š
  â€– We use a normal random function model to make a regressor. â¦‰
â¦‰

Â§ Definition â¦‰
Â¶ â¦Š
  â€– Let $F: Î© â†’ (A â†’ ğ—¥)$ be a normal random function with
    mean function $m: A â†’ ğ—¥$ and covariance function $k: A Ã—A
    â†’ ğ—¥$ over the probability space $(Î©, ğ’œ, ğ—£)$. â¦‰

  â€– Let the family of random variables (or stochastic process)
    of $F$ be $f: A â†’ (Î© â†’ ğ—¥)$. â¦‰
â¦‰

Â¶ â¦Š
  â€– Let $e$ be a normal random vector with mean zero and
    covariance $Î£_{e}$. â¦‰

  â€– Let $a^1, â€¦, a^n âˆˆ A$. â¦‰

  â€– We sometimes call the sequence $a^1, â€¦, a^n$ the â¬designâ­. â¦‰

  â€– Define $y: Î© â†’ ğ—¥^d$ by
    â—‡ â¦Š
      â€– y_i = f(a^i) + e_i â¦‰
    â¦‰â¦‰

  â€– We call $y$ the â¬observation vectorâ­ or â¬observation random
    vectorâ­. â¦‰

  â€– We call $e$ the â¬error vectorâ­ or â¬noise vectorâ­. â¦‰

  â€– In this context, $f(a^i)$ is sometimes called the â¬signalâ­. â¦‰
â¦‰

Â¶ â¦Š
  â€– Let $b^1, â€¦, b^m âˆˆ A$. â¦‰

  â€– Define $z: Î© â†’ ğ—¥^d$ by $z_i = f(b^i)$ for $i = 1, â€¦, n$. â¦‰

  â€– So $z_i$ is the random variable corresponding to the family
    at index $b^i âˆˆ A$. â¦‰

  â€– Then $(y, z)$ is normal. â¦‰

  â€– We call the conditional density of $z$ given $y$ the
    â¬predictive densityâ­ for $b$ given $a$. â¦‰
â¦‰

<statement type='proposition'>
  â€– Define $m_{a} âˆˆ ğ—¥^{n}$ by $\transpose{(m(a^1),â‹¯,m(a^n))}$ and
    define $m_{b}$ by $\transpose{(m(b^1), â‹¯, m(b^m))}$.
    â€  â¦Š
      â€– Future editions will fix the re-use of the symbol $m$. â¦‰
    â¦‰â¦‰

  â€– Define $Î£_a âˆˆ ğ—¥^{n Ã—n}$ by
    â—‡ â¦Š
      â€– \pmat{ â¦‰

      â€– k(a^1, a^1) ï¼† â‹¯ ï¼† k(a^1, a^n) áœ¶ â¦‰

      â€– â‹® ï¼† â‹± ï¼† â‹® áœ¶ â¦‰

      â€– k(a^n, a^1) ï¼† â‹¯ ï¼† k(a^n, a^n) áœ¶ â¦‰

      â€– } â¦‰
    â¦‰
    and define $Î£_{ba} âˆˆ ğ—¥^{m Ã—n}$ by
    â—‡ â¦Š
      â€– \pmat{ â¦‰

      â€– k(b^1, a^1) ï¼† â‹¯ ï¼† k(b^1, a^n) áœ¶ â¦‰

      â€– â‹® ï¼† â‹± ï¼† â‹® áœ¶ â¦‰

      â€– k(b^m, a^1) ï¼† â‹¯ ï¼† k(b^m, a^n) áœ¶ â¦‰

      â€– }. â¦‰
    â¦‰

    â€– The predictive density $g_{z |y}(Â·, Î³): ğ—¥^m â†’ ğ—¥$ of $b âˆˆ
      A$ for design $a^1, â€¦, a^n$ is normal with mean.
      â—‡ â¦Š
        â€– m_b + K_{ba}\inv{(K_{a} + Î£_{e})}(Î³ - m_a) â¦‰
      â¦‰
      and covariance
      â—‡ â¦Š
        â€– Î£_{b} - Î£_{ba}\inv{(Î£_{a} + Î£_{e})}Î£_{ab}. â¦‰
      â¦‰â¦‰â¦‰
</statement>