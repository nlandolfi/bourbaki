<!DOCTYPE html>
  <meta charset="utf-8"/>
  <head>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../fonts.css">
    <script src="../pdfjs/build/pdf.js"></script>
  </head>
  <body>
    <div class="header">
      <span class="listing no-border" id="header-trademark-and-title">
        <img id="header-trademark" src="../trademark.jpg" onclick="location.href='../index.html'">
        <span id="header-title" onclick="location.href='./normal_random_function_regressors.pdf#page=2'"> Normal Random Function Regressors </span>
      </span>
    </div>
    <div class="subheader">
      <div disabled class="need label"> Links: </div>
      <div class="need" tabindex="0" onclick="location.href='./normal_random_function_regressors.pdf#page=2'" onkeypress="location.href='./normal_random_function_regressors.pdf#page=2'">
        <span> Sheet PDF </span>
        <span class="caret">›</span>
      </div>
      <div class="need" tabindex="0" onclick="location.href='./normal_random_function_regressors-graph.pdf'" onkeypress="location.href='./normal_random_function_regressors-graph.pdf'">
        <span> Graph PDF </span>
        <span class="caret">›</span>
      </div>
      
        <div disabled class="need label"> Needs: </div>
        
            <div class="need" tabindex="0" onclick="location.href='./loss_functions.html'" onkeypress="location.href='./loss_functions.html'">
              <span>
                Loss Functions
              </span>
              <span class="caret">›</span>
            </div>
        
            <div class="need" tabindex="0" onclick="location.href='./normal_random_function_predictive_densities.html'" onkeypress="location.href='./normal_random_function_predictive_densities.html'">
              <span>
                Normal Random Function Predictive Densities
              </span>
              <span class="caret">›</span>
            </div>
        
      
      
    </div>

      <link rel="stylesheet" href="../katex/katex.min.css">
      <script src="../katex/katex.min.js"></script>
      <script src="../katex/auto-render.min.js"></script>
      <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(
          document.body,
          {
            delimiters: [
              {left: "$$", right: "$$", display: true},
              {left: "$", right: "$", display: false},
            ],
          },
        );
      });
    </script>
    <div id="sheet-card" class="card">
      <div class="sheet-listing" id="why"><h1 class="sheet">1. Why</h1></div><div class="sheet-listing"><p class="sheet"> We use a loss function and a predictive density to construct a regressor on the domain of the random process.</p></div><div class="sheet-listing" id="setup"><h1 class="sheet">2. Setup</h1></div><div class="sheet-listing"><p class="sheet"> Let $\ell: \R \times \R \to \R$ be a loss function. We choose a predictor to minimize the expected loss under the predictive density.</p></div><div class="sheet-listing"><h2 class="sheet" id="squared_error_case">2.1 Squared Error Case</h2></div><div class="sheet-listing"><p class="sheet"> Consider $\ell(\alpha, \beta) = \parens{\alpha - \beta}^2$. The \t{minimum squared error normal random function predictor} or \t{minimum squared error gaussian process predictor} for dataset $(a^1, \gamma_1), \dots, (a^n, \gamma_n)$ in $A \times \R$ is the predictor which minimizes the squared error loss. Since the predictive density is normal, the minimizer is the conditional mean.</p></div><div class="sheet-listing"><h2 class="sheet" id="absolute_error_case">2.2 Absolute Error Case</h2></div><div class="sheet-listing"><p class="sheet"> Consider $\ell(\alpha, \beta) = \abs{\alpha - \beta}$. The \t{minimum absolute deviation normal random function predictor} or \t{minimum absolute deviation gaussian process predictor} for dataset $(a^1, \gamma_1), \dots, (a^n, \gamma_n)$ in $A \times \R$ is the predictor which minimizes the absolute deviation loss. For any density, the solution is the median. Since the predictive density is normal, and so symmetric, the median is the conditional mean. In other words, the minimum absolute deviation normal random function predictor coinicides with the minimium squared error normal random function predictor.</p></div><div class="sheet-listing" id="definition"><h1 class="sheet">3. Definition</h1></div><div class="sheet-listing"><p class="sheet"> For this reason, the \t{normal random function predictor} or \t{gaussian process predictor} for dataset $(a^1, \gamma_1), \dots, (a^n, \gamma_n)$ in $A \times \R$ is $h: A \to \R$ defined by \[ h(x) = m(x) + \pmat{k(x,a^1) \cdots k(x, a^n)}\invp{\Sigma_{a} + \Sigma_{e}}\parens{\gamma - m_{a}}. \] In other words, the regressor which assigns to each point its conditional mean.</p></div><div class="sheet-listing"><p class="sheet"> Notice that $h$ is an affine function of $\gamma$. If the mean function $m \equiv 0$ then $h$ is linear in $\gamma$. This is sometimes called a \t{linear estimator}.\footnote{We avoid the other terminology we have seen used---linear predictor---because the predictor $h$ is not linear in its input $x$.} Alternatively, notice (in the zero mean setting) that $h$ is a linear combination of $n$ kernel function $k(x, a^i)$ for $i = 1, \dots, n$. Specifically, $h$ is a linear combination of</p></div><div class="sheet-listing"><p class="sheet"> The process of using a normal random function predictor is often called \t{Gaussian process regression} or (especially in spatial statistics) \t{kriging}. The upside is that a gaussian process predicor interpolates the data, is smooth, and the so-called variance increases with the distance from the data.\footnote{This last piece is true for certain covariance kernels and will be clarified in future editions.}</p></div>
    </div>

    <div style="display: flex; flex-direction: row; justify-content: center; flex-wrap: wrap">

    <div id="wrapper1">
      <canvas id="page1" style="direction: ltr;"></canvas>
    </div>
    <div id="wrapper2">
      <canvas id="page2" style="direction: ltr;"></canvas>
    </div>
    <div id="wrapper3">
    <canvas id="page3" style="border: 1px solid black; direction: ltr;"></canvas>
    </div>
      <script id="script">
        // If absolute URL from the remote server is provided, configure the CORS
        // header on that server.
        var url = './normal_random_function_regressors.pdf';

        // The workerSrc property shall be specified.
        pdfjsLib.GlobalWorkerOptions.workerSrc =
          '../pdfjs/build/pdf.worker.js';

        var PRINT_RESOLUTION = 300;

        function render(page, wrapper, canvas) {
          var scale = 7;
          var viewport = page.getViewport({scale: scale});
          var context = canvas.getContext('2d');

          canvas.width = viewport.width;
          canvas.height = viewport.height;
          canvas.style.width = "100%";
          canvas.style.height = "100%";
          wrapper.style.width = Math.floor(viewport.width/scale) + 'pt';
          wrapper.style.height = Math.floor(viewport.height/scale) + 'pt';

          // see https://stackoverflow.com/questions/37861686/pdfjs-blurry-pdf-on-ipad
          // who knows if this works...
          context.imageSmoothingEnabled = false;
          context.webkitImageSmoothingEnabled = false;
          context.mozImageSmoothingEnabled = false;
          context.oImageSmoothingEnabled = false;

          /*

          if (window.devicePixelRatio > 1) {
            var canvasWidth = canvas.width;
            var canvasHeight = canvas.height;

            canvas.width = canvasWidth * window.devicePixelRatio;
            canvas.height = canvasHeight * window.devicePixelRatio;
            canvas.style.width = canvasWidth + "px";
            canvas.style.height = canvasHeight + "px";

            context.scale(window.devicePixelRatio, window.devicePixelRatio);
          }
          //end see
          */

          var renderContext = {
            canvasContext: context,
            viewport: viewport
          };
          page.render(renderContext);
        }

        // Asynchronous download PDF
        var loadingTask = pdfjsLib.getDocument(url);
        loadingTask.promise.then(function(pdf) {

          // Fetch the first page
          pdf.getPage(2).then(function(page) {
              render(page, document.getElementById('wrapper1'), document.getElementById('page1'));
          });

          // Fetch the second page
          pdf.getPage(3).then(function(page) {
            render(page, document.getElementById('wrapper2'), document.getElementById('page2'));
          });

          // Fetch the third page
          pdf.getPage(4).then(function(page) {
            render(page, document.getElementById('wrapper3'), document.getElementById('page3'));
          });
        });
      </script>

    <!-- PAGES -->
    <!--
    <iframe id="sheet-pdf" src="./normal_random_function_regressors.pdf#page=2">
    </iframe>
    <iframe id="sheet-pdf" src="./normal_random_function_regressors.pdf#page=3">
    </iframe>
    -->
    <!-- PAGES -->

    </div>

    <!-- <iframe id="graph-pdf" src="./normal_random_function_regressors-graph.pdf">
    </iframe>
    -->

    <span id="footer">
      Copyright 2021 The Bourbaki Authors. Version c8a962f40.
    </span>
  </body>
</html>
